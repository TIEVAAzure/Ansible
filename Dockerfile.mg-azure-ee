FROM quay.io/ansible/awx-ee:24.6.1

USER 0

# Create an isolated virtualenv for Azure CLI so we don't touch the system Python
RUN dnf install -y python3-pip && \
    dnf clean all && \
    python3 -m venv /opt/azcli && \
    /opt/azcli/bin/python -m pip install --upgrade pip && \
    /opt/azcli/bin/python -m pip install azure-cli && \
    ln -s /opt/azcli/bin/az /usr/local/bin/az

USER 1000
