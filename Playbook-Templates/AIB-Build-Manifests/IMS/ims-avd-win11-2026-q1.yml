# AIB Build Manifest (IMS - AVD Win11 - 2026 Q1)
# Controls:
# - Which Microsoft built-ins run (must/optional)
# - Any parameter values required by those built-ins (GUI dropdown equivalents)
# - Which of your custom scripts run from blob (order matters)

manifest_version: 1
customer: "IMS"
image_version: "2026-Q1"
location: "uksouth"

# ----------------------------
# Microsoft built-in customizers
# ----------------------------
microsoft_builtins:
  must:
    set_default_os_language: true
    time_zone_redirection: true
    disable_storage_sense: true
    install_fslogix: true
    configure_rdp_shortpath: true
    install_multimedia_redirection: true
    configure_windows_optimizations: true
    remove_microsoft_office_applications: true
    apply_windows_updates: true

  optional:
    install_languages: false
    enable_kerberos_and_azure_ad: false
    enable_screen_capture_protection: false
    configure_session_timeouts: false

# ----------------------------
# Built-in parameters (GUI dropdown equivalents)
# ----------------------------

os_settings:
  default_os_language: "en-GB"
  install_languages:
    - "en-GB"

# IMPORTANT:
# You asked to allow this to be BLANK.
# Leave profile_path as "" and your updated avd-ms-builtins.yml should skip passing it.
fslogix_settings:
  profile_path: ""
  vhd_size_mb: 30000

multimedia_settings:
  vc_redist: "x64"
  enable_edge: "Yes"
  enable_chrome: "Yes"

office_settings:
  type: "Remove"
  version: "32"
  applications:
    - "Publisher"
    - "PowerPoint"
    - "OneNote"
    - "Excel"
    - "Access"

# Only used if enable_screen_capture_protection: true
screen_capture_settings:
  block_option: "BlockClient"

# Only used if configure_session_timeouts: true
# Convention: 0 = Never (your mapping/playbook should translate if needed)
session_timeouts:
  disconnected_minutes: 30
  idle_minutes: 360
  active_minutes: 0
  signout_minutes: 0

windows_optimizations:
  optimizations:
    - "WindowsMediaPlayer"
    - "ScheduledTasks"
    - "DefaultUserSettings"
    - "Services"
    - "NetworkOptimizations"
    - "DiskCleanup"
    - "Edge"
    - "RemoveOneDrive"
    - "Autologgers"

# ----------------------------
# Custom scripts (from your blob container)
# Order matters: these run top -> bottom
# blob_path is RELATIVE to the image_version prefix
# Example final URI becomes:
# https://<sa>.blob.core.windows.net/<container>/<image_version>/<blob_path>?<sas>
# ----------------------------
custom_scripts:
  # Generic scripts
  # (leave empty for now)

  # Application installs
  - name: "AdobeReaderDC"
    blob_path: "Applications/AVD-AIB-AdobeReaderDC-Update.ps1"

  - name: "8x8-Update"
    blob_path: "Applications/AVD-AIB-8x8-Update.ps1"

  # Customer scripts
  - name: "AVD-AIB-3rdParty-Download"
    blob_path: "Customer/IMS/AVD-AIB-3rdParty-Download.ps1"

  - name: "AVD-AIB-AppInstalls"
    blob_path: "Customer/IMS/AVD-AIB-AppInstalls.ps1"
